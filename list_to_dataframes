

tables = []
for i in range(0, len(dates), 2):
    start_date = dates[i]
    end_date = dates[i + 1]
    table_name = f'spine_{start_date}_{end_date}'
    cur.execute(f'CREATE TABLE {table_name} AS SELECT * FROM spine WHERE date BETWEEN {start_date} AND {end_date}')
    tables.append(table_name)

merged_table = 'spine_merged'
cur.execute(f'CREATE TABLE {merged_table} AS SELECT * FROM {tables[0]}')
for table in tables[1:]:
    cur.execute(f'INSERT INTO {merged_table} SELECT * FROM {table}')

conn.commit()
